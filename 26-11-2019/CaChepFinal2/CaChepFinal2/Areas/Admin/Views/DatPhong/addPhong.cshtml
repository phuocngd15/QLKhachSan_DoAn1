@model IEnumerable<CaChepFinal2.Data.Phong>
@using CaChepFinal2.Extensions
@using Microsoft.AspNetCore.Http

@inject IHttpContextAccessor HttpContextAccessor
@{
    ViewData["Title"] = "addPhong";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Chọn Phòng thuê</h1>
<div>
    <a asp-action="CreateDatPhong">Back</a>
</div>
<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ShortDescription)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Price)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImageUrl)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TrangThai)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.GetLoaiPhong)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ShortDescription)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Price)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ImageUrl)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TrangThai)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.GetLoaiPhong.Id)
                </td>
                <td>
                    <div class="form-group">
                        @{
                            bool isInBag = false;
                            List<int> lstCart = HttpContextAccessor.HttpContext.Session.Get<List<int>>("ssPhongCart");
                            if (lstCart != null && lstCart.Contains(item.Id)) { isInBag = true; }
                        }
                        @if (isInBag)
                        {
                            <button type="submit" value="Remove khỏi phiếu" asp-action="remove" asp-route-id="@item.Id" class="btn btn-danger form-control">Remove From Phiếu</button>

                        }
                        else
                        {
                            <button type="submit" value="Add vào phiếu" asp-action="addPhong" asp-route-id="@item.Id" class="btn btn-primary form-control">Add To Phiếu</button>
                            @*<a asp-action="addPhong" asp-route-id="@item.Id">Details</a>*@ 

                        }

                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>

